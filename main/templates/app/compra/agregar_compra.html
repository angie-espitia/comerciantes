{% extends 'app/base_app.html' %}
{% block title %} Inicio {% endblock %}

{%  block content %}

 <h1 class="mt-4">Nueva compra</h1> 

 <div id="alert-form"></div>

 <div class="container">
    
    <form class="form" method="POST"  id="formulario_registro_compra" enctype="multipart/form-data">
      {% csrf_token %}
      <div class="row">
        <div class="col-md-4 col-sm-4 col-lg-4">
          {{ form.fecha.label }}
          <br>
          {{ form.fecha }}
        </div>
      </div>

      {{ detalle_compra_formset.management_form }}
      
        <div id="form_set">
        {% for form in detalle_compra_formset %}
        <table class="table table-striped table-bordered">
        <br>
          <thead>
            <tr>
              <th>{{ form.producto_id.label }}</th>
              <th>{{ form.proveedor_id.label }}</th>
              <th>{{ form.cantidad.label }}</th>
              <th>{{ form.valor_unitario.label }}</th>
              <th>{{ form.total_producto.label }}</th>
            </tr>          
          </thead>
          <tbody>
            <tr>
              <td>{{ form.producto_id }}</td>
              <td>{{ form.proveedor_id }}</td>
              <td>{{ form.cantidad }}</td>
              <td>{{ form.valor_unitario }}</td>
              <td>{{ form.total_producto }}</td>
            </tr>
          </tbody>
        </table>
        {% endfor %}
        </div>
      
      
        <div id="empty_form" style="display:none">
          <table class="table table-striped table-bordered">
            <tbody>
              <tr>
                <td>{{ detalle_compra_formset.empty_form.producto_id }}</td>
                <td>{{ detalle_compra_formset.empty_form.proveedor_id }}</td>
                <td>{{ detalle_compra_formset.empty_form.cantidad }}</td>
                <td>{{ detalle_compra_formset.empty_form.valor_unitario }}</td>
                <td>{{ detalle_compra_formset.empty_form.total_producto }}</td>
              </tr>
            </tbody>
          </table>
        </div>
        <input type="hidden" value="1" name="additems" id="additems">
        <input type="button" id="additemsbutton" value="Add Project">
  
      <div class="row">
        <div class="col-md-4 col-sm-4 col-lg-4 p-2">
          {{ form.sub_total.label }}
          {{ form.sub_total }}
        </div>
        <div class="col-md-4 col-sm-4 col-lg-4 p-2">
          {{ form.IVA.label }}
          {{ form.IVA }}
        </div>
        <div class="col-md-4 col-sm-4 col-lg-4 p-2">
          {{ form.total.label }}
          {{ form.total }}
        </div>
      </div>

      <br>
      <button class="save btn btn-primary" type="submit">Guardar</button>
      <br><br>
    </form>    

  </div>

 {% endblock %} 

  {% block javascript %}
<script type='text/javascript'>
  var form_num = 0;
  $(document).ready(function() {
        $("#additemsbutton").on('click',function(event)
        {
          ++form_num;
          $('#form_set').append($('#empty_form').html().replace(/__prefix__/g, form_num));
          $("#additems").val(form_num + 1);
       });
     });
</script>
 {% endblock %} 

